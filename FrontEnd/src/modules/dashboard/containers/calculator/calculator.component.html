<layout-dashboard><sb-dashboard-head title="Calculator" [hideBreadcrumbs]="true"></sb-dashboard-head>

  <div class="container" id="main-container">
    <div class="row">
      <div class="col-lg-5 text-center">
        <div class="card left-card text-center">
          <div class="card-header text-center">
            Runway Conditions
          </div>
          <div class="card-body">
            <button class="btn btn-dark parameter-button" (click)="openManualModal()" id="ManualButton">Manual</button>
            <button class="btn btn-dark parameter-button" (click)="openAutomaticModal()" id="AutomaticButton">Automatic</button>
          </div>
        </div>
        <div class="card text-center left-card">
          <div class="card-header text-center">
            Mission Specific Info
          </div>
          <div class="card-body">
            <div class="row d-flex justify-content-center">
              <div class="col-lg-6">
                <select class="btn btn-dark pilot-input" id="Pilot1ProfileSelect">
                  <option>Choose Pilot 1</option>
                </select>
                <select [disabled] = "pilot1NotSelected" class="btn btn-dark pilot-input" id="Pilot2ProfileSelect">
                  <option>Choose Pilot 2</option>
                  <option>None</option>
                </select>
              </div>  
              <div class="col-lg-6 my-auto">
                <label>Approximate Flight Time:</label>
                <div class="row text-left">
                  <input type="text" class="time-item text-right" id="MissionTimeInput" value="">
                  <label class="time-item">&nbsp;minutes</label>
                </div>
              </div>
            </div>  
          </div>
        </div>
        <div class="card text-center left-card">
          <div class="card-header text-center">
            Aircraft Profile
          </div>
          <div class="card-body">
            <select class="btn btn-dark" id="AircraftProfileSelect">
              <option>Choose Profile</option>
            </select>
            <button class="btn btn-dark">Info</button>
          </div>
        </div>
        <button class="btn-lg btn-dark" [disabled] = "calculateLoading" id="CalculateButton" (click) = "calculate()">
          <span *ngIf="calculateLoading" class="spinner-border spinner-border-sm mr-1"></span>
          Calculate
        </button>
      </div>  
      <div class="col-lg-6 text-center" id="RightColumn">
        <div class="row d-flex justify-content-center">
          <div class="card performance-card">
            <div class="card-header text-center">
                Performance Parameters
            </div>
            <ul class="list-group list-group-flush align-center">
              <li class="list-group-item">
                <button class="btn btn-dark performance-selection" id="DisplayTakeoffButton">Takeoff</button>
                <button class="btn btn-outline-dark performance-selection" id="DisplayLandingButton">Landing</button>
                <button class="btn btn-outline-dark performance-selection" id="DisplayStallSpeedButton">Stall Speeds</button>
              </li>
            </ul>
            <ul class="list-group list-group-flush align-center">
              <li class="list-group-item">
                  <button class="btn btn-dark measurement-button" id="ImperialButton" [disabled]="notCalculated">Imperial</button>
                  <button class="btn btn-outline-dark measurement-button" id="MetricButton" [disabled]="notCalculated">Metric</button>
              </li>
            </ul>
          
            <!-- Takeoff output list -->
            <ul class="list-group list-group-flush align-center" [ngStyle]="{'display':displayTakeoff}">
              <li class="list-group-item p-0">
                <div class="row d-flex justify-content-left m-0">
                  <div class="shadow-lg bg-dark p-2 m-0 output-label-block">
                    <h2 class="output-label">Takeoff Speed</h2>
                  </div>
                  <div class="shadow-lg output-block bg-white p-2">
                    <h3 id="takeoff-speed-output">&nbsp;</h3>
                  </div>
                  <div class="shadow-lg bg-dark speed-unit-block text-center">
                    <h4 class="output-label" id="takeoff-speed-unit">kts</h4>
                  </div>
                </div> 
              </li>
              <li class="list-group-item p-0">
                <div class="row d-flex justify-content-left m-0">
                  <div class="shadow-lg bg-dark p-2 m-0 output-label-block">
                    <h2 class="output-label">Takeoff Distance</h2>
                  </div>
                  <div class="shadow-lg output-block bg-white p-2">
                    <h3 id="takeoff-distance-output">&nbsp;</h3>
                  </div>
                  <div class="shadow-lg bg-dark p-2 m-0 unit-block  text-center">
                    <h4 class="output-label" id="takeoff-distance-unit">ft</h4>
                  </div>
                </div> 
              </li>
              <li class="list-group-item p-0">
                <div class="row d-flex justify-content-left m-0">
                  <div class="shadow-lg bg-dark p-2 m-0 output-label-block">
                    <h2 class="output-label">Ground-Run Distance</h2>
                  </div>
                  <div class="shadow-lg output-block bg-white p-2">
                    <h3 id="ground-distance-output">&nbsp;</h3>
                  </div>
                  <div class="shadow-lg bg-dark p-2 m-0 unit-block text-center">
                    <h4 class="output-label" id="ground-run-unit">ft</h4>
                  </div>
                </div> 
              </li>
              <li class="list-group-item p-0">
                <div class="row d-flex justify-content-left m-0">
                  <div class="shadow-lg bg-dark p-2 m-0 output-label-block">
                    <h2 class="output-label">Accel-Stop Distance</h2>
                  </div>
                  <div class="shadow-lg output-block bg-white p-2">
                    <h3 id="accel-distance-output">&nbsp;</h3>
                  </div>
                  <div class="shadow-lg bg-dark p-2 m-0 unit-block text-center">
                    <h4 class="output-label" id="accel-stop-unit">ft</h4>
                  </div>
                </div> 
              <li class="list-group-item p-0">
                <div class="row d-flex justify-content-left m-0">
                  <div class="shadow-lg bg-dark p-2 m-0 output-label-block">
                    <h2 class="output-label">Speed Over Obstacle</h2>
                  </div>
                  <div class="shadow-lg output-block bg-white p-2">
                    <h3 id="speed-over-obstacle-output">&nbsp;</h3>
                  </div>
                  <div class="shadow-lg bg-dark m-0 speed-unit-block text-center">
                    <h4 class="output-label" id="speed-over-unit">kts</h4>
                  </div>
                </div> 
              </li>
            </ul>
          
            <!-- Landing Output List -->
            <ul class="list-group list-group-flush align-center" [ngStyle]="{'display':displayLanding}">
              <li class="list-group-item p-0">
                <div class="row d-flex justify-content-left m-0">
                  <div class="shadow-lg bg-dark p-2 m-0 output-label-block">
                    <h2 class="output-label">Landing Distance</h2>
                  </div>
                  <div class="shadow-lg output-block bg-white p-2">
                    <h3 id="landing-distance-output">&nbsp;</h3>
                  </div>
                  <div class="shadow-lg bg-dark p-2 m-0 unit-block text-center">
                    <h4 class="output-label" id="landing-distance-unit">ft</h4>
                  </div>
                </div> 
              </li>
              <li class="list-group-item p-0">
                <div class="row d-flex justify-content-left m-0">
                  <div class="shadow-lg bg-dark p-2 m-0 output-label-block">
                    <h2 class="output-label">Approach Speed</h2>
                  </div>
                  <div class="shadow-lg output-block bg-white p-2">
                    <h3 id="approach-speed-output">&nbsp;</h3>
                  </div>
                  <div class="shadow-lg bg-dark m-0 speed-unit-block text-center">
                    <h4 class="output-label" id="approach-speed-unit">kts</h4>
                  </div>
                </div> 
              </li>
              <li class="list-group-item p-0">
                <div class="row d-flex justify-content-left m-0">
                  <div class="shadow-lg bg-dark p-2 m-0 output-label-block">
                    <h2 class="output-label">Touch-Down Speed</h2>
                  </div>
                  <div class="shadow-lg output-block bg-white p-2">
                    <h3 id="touch-down-speed-output">&nbsp;</h3>
                  </div>
                  <div class="shadow-lg bg-dark m-0 speed-unit-block text-center">
                    <h4 class="output-label" id="touch-down-unit">kts</h4>
                  </div>
                </div> 
              </li>
            </ul>
          
            <!-- Stall speed output list -->
            <ul class="list-group list-group-flush align-center" [ngStyle]="{'display':displaySpeeds}">
              <li class="list-group-item p-0">
                <div class="row d-flex justify-content-left m-0">
                  <div class="shadow-lg bg-dark p-2 m-0 output-label-block">
                    <h3 class="output-label">VS1, Flaps 25&deg;, Gear Extended</h3>
                  </div>
                  <div class="shadow-lg output-block bg-white p-2">
                    <h3 id="vs1-output" >&nbsp;</h3>
                  </div>
                  <div class="shadow-lg bg-dark m-0 speed-unit-block text-center">
                    <h4 class="output-label" id="vs1-unit">kts</h4>
                  </div>
                </div> 
              </li>
              <li class="list-group-item p-0">
                <div class="row d-flex justify-content-left m-0">
                  <div class="shadow-lg bg-dark p-2 m-0 output-label-block">
                    <h3 class="output-label">VS0, Gear Down, Ground Proximity</h3>
                  </div>
                  <div class="shadow-lg output-block bg-white p-4">
                    <h3 id="vs0-gu-output">&nbsp;</h3>
                  </div>
                  <div class="shadow-lg bg-dark m-0 unit-block-big text-center">
                    <h4 class="output-label" id="vs0-gu-unit">kts</h4>
                  </div>
                </div> 
              </li>
              <li class="list-group-item p-0">
                <div class="row d-flex justify-content-left m-0">
                  <div class="shadow-lg bg-dark p-2 m-0 output-label-block">
                    <h3 class="output-label">VS0, Gear Down, No Ground Proximity</h3>
                  </div>
                  <div class="shadow-lg output-block bg-white p-4">
                    <h3 id="vs0-gd-output">&nbsp;</h3>
                  </div>
                  <div class="shadow-lg bg-dark m-0 unit-block-big text-center">
                    <h4 class="output-label" id="vs0-gd-unit">kts</h4>
                  </div>
                </div> 
              </li>
            </ul>
          </div>
        </div>
        <div class="row d-flex justify-content-center">
          <img src="assets/img/runway.png" id="RunwayPicture"/>
          <img src="assets/img/runway.png" id="RunwayPicture"/>
        </div>
      </div> 
    </div>
  </div>

<div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':displaySaveStyleAutomatic}">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Query Runway</h4>
      </div>
      <div class="modal-body">
        <div class="row d-flex justify-content-center">
          <form [formGroup]="formAutomaticModal" (ngSubmit)="findRunways()">
                <div class="row d-flex justify-content-center">
                  <label for="airportInput">Enter Airport ID:</label>
                </div>
                <div class="row d-flex justify-content-center form-group" [formGroup]="formAutomaticModal">
                  <input type="text" formControlName="airportInput" id="airportID" class="form-control" [ngClass]="{ 'is-invalid': submitted && f['airportInput'].errors }" />
                  <div *ngIf="submitted && f['airportInput'].errors" class="invalid-feedback">
                    <div *ngIf="f['airportInput'].errors['required']">Airport ID is required</div>
                    <div *ngIf="f['airportInput'].errors['maxlength']">Airport ID must be less than 5 characters.</div>
                    <div *ngIf="f['airportInput'].errors['minlength']">Airport ID must be at least 2 characters</div>
                  </div>
                </div>
              <div class="row d-flex justify-content-center">
                <button type="submit" [disabled]="runwaysLoading" id="FindRunwaysButton" class="btn btn-outline-dark active text-center" >
                  <span *ngIf="runwaysLoading" class="spinner-border spinner-border-sm mr-1"></span>
                  Find Runways
                </button>
              </div>
          </form>
        </div>
        <div class="row d-flex justify-content-center">
            <label>Select Takeoff Runway:</label>
        </div>
        <div class="row d-flex justify-content-center">
            <div class="card border-1 mb-4" id="runway-button-group"></div> 
        </div>
        <div class="row d-flex justify-content-center">
            <label for=RunwaySideButton1>Select Runway Starting Side: </label>
        </div>
        <div class="row d-flex justify-content-center">
            <div class="blank-card mt-2">
                <button type="button" id="RunwaySideButton1" class="btn btn-outline-dark text-center side-button">Side 1</button>
                <button type="button" id="RunwaySideButton2" class="btn btn-outline-dark text-center side-button">Side 2</button>
            </div>
        </div>
      </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-dark active" (click)="closeAutomaticModal(false)">Close</button>
          <button type="button" class="btn btn-outline-dark active" (click)="closeAutomaticModal(true)">Save</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':displaySaveStyleManual}">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header d-flex justify-content-center">
          <h4 class="modal-title text-center">Input Runway Conditions</h4>
        </div>
        <div class="modal-body">
          <div class="row d-flex justify-content-center">
            <form [formGroup]="formManualModal" (ngSubmit)="saveManual()">
              <div class="form-group" [formGroup]="formManualModal">
                  <label for="temperature">Temperature</label>
                  <input type="text" formControlName="temperature" class="form-control" placeholder="Enter temperature" [ngClass]="{ 'is-invalid': submittedManualModal && fManual['temperature'].errors }" />
                  <div *ngIf="submittedManualModal && fManual['temperature'].errors" class="invalid-feedback">
                      <div *ngIf="fManual['temperature'].errors['required']">Temperature is required</div>
                      <div *ngIf="fManual['temperature'].errors['maxlength'] && !fManual['temperature'].errors['pattern']">Temperature cannot be greater than 3 digits.</div>
                      <div *ngIf="fManual['temperature'].errors['pattern']">Temperature must be numeric.</div>
                  </div>
              </div> 
              <div class="form-group" [formGroup]="formManualModal">
                <label for="slope">Runway Slope</label>
                <input type="text" formControlName="slope" class="form-control" placeholder="Enter slope" [ngClass]="{ 'is-invalid': submittedManualModal && fManual['slope'].errors }" />
                <div *ngIf="submittedManualModal && fManual['slope'].errors" class="invalid-feedback">
                    <div *ngIf="fManual['slope'].errors['pattern']">Slope must be numeric.</div>
                </div>
              </div> 
              <div class="form-group" [formGroup]="formManualModal">
                <label for="runwayLength">Runway Length</label>
                <input type="text" formControlName="runwayLength" class="form-control" placeholder="Enter runway length" [ngClass]="{ 'is-invalid': submittedManualModal && fManual['runwayLength'].errors }" />
                <div *ngIf="submittedManualModal && fManual['runwayLength'].errors" class="invalid-feedback">
                    <div *ngIf="fManual['runwayLength'].errors['pattern']">Slope must be numeric.</div>
                </div>
              </div> 
              <div class="form-group" [formGroup]="formManualModal">
                <label for="precipitation">Is the runway wet?</label>
                 <div class="row d-flex justify-content-left">
                  <input type="radio" formControlName="precipitationYes" class="radio" [ngClass]="{ 'is-invalid': submittedManualModal && fManual['slope'].errors }"/>
                  <label for="precipitationYes" class="radio-label">Yes</label>
                  <input type="radio" formControlName="precipitationNo" class="radio" [ngClass]="{ 'is-invalid': submittedManualModal && fManual['slope'].errors }"/>
                  <label for="precipitationNo" class="radio-label">No</label>
                </div>
              </div> 
              <div class="form-group" [formGroup]="formManualModal">
                <label for="precipitation">What is the runway surface type?</label>
                 <div class="row d-flex justify-content-left">
                  <input type="radio" formControlName="concreteRunway" class="radio" [ngClass]="{ 'is-invalid': submittedManualModal && fManual['slope'].errors }"/>
                  <label for="concreteRunway" class="radio-label">Concrete</label>
                  <input type="radio" formControlName="grassRunway" class="radio" [ngClass]="{ 'is-invalid': submittedManualModal && fManual['slope'].errors }"/>
                  <label for="grassRunway" class="radio-label">Grass</label>
                </div>
              </div> 
              <div class="form-group" [formGroup]="formManualModal">
                <label for="pressureAltitude">PSI</label>
                <input type="text" formControlName="pressureAltitude" class="form-control" placeholder="Enter pressure altitude" [ngClass]="{ 'is-invalid': submittedManualModal && fManual['pressureAltitude'].errors }" />
                <div *ngIf="submittedManualModal && fManual['pressureAltitude'].errors" class="invalid-feedback">
                    <div *ngIf="fManual['pressureAltitude'].errors['pattern']">Pressure Altitude must be numeric.</div>
                </div>
              </div> 
              <div class="form-group" [formGroup]="formManualModal">
                <label for="headwind">Headwind</label>
                <input type="text" formControlName="headwind" class="form-control" placeholder="Enter headwind" [ngClass]="{ 'is-invalid': submittedManualModal && fManual['headwind'].errors }" />
                <div *ngIf="submittedManualModal && fManual['headwind'].errors" class="invalid-feedback">
                    <div *ngIf="fManual['headwind'].errors['pattern']">Headwind must be numeric.</div>
                </div>
              </div> 
            </form>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-dark active" (click)="closeManualModal(false)">Close</button>
          <button type="button" class="btn btn-outline-dark active" (click)="closeManualModal(true)">Save</button>
        </div>
      </div> 
    </div>
  </div>

</layout-dashboard>
